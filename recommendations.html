---
layout: default
title: Repository Recommendations
---

<style>
    .repo-recommendations {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .config-section {
        background: #f6f8fa;
        border: 1px solid #d0d7de;
        border-radius: 6px;
        padding: 20px;
        margin-bottom: 30px;
    }

    .config-section h2 {
        margin-top: 0;
        font-size: 20px;
        color: #24292f;
    }

    .input-group {
        margin-bottom: 15px;
    }

    .input-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: #24292f;
    }

    .input-group input {
        width: 100%;
        max-width: 400px;
        padding: 8px 12px;
        border: 1px solid #d0d7de;
        border-radius: 6px;
        font-size: 14px;
    }

    .btn {
        background-color: #2da44e;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .btn:hover {
        background-color: #2c974b;
    }

    .btn:disabled {
        background-color: #94d3a2;
        cursor: not-allowed;
    }

    .loading {
        display: none;
        color: #57606a;
        margin: 20px 0;
    }

    .loading.active {
        display: block;
    }

    .error {
        background-color: #fff8c5;
        border: 1px solid #d4a72c;
        border-radius: 6px;
        padding: 15px;
        margin: 20px 0;
        color: #24292f;
        display: none;
    }

    .error.active {
        display: block;
    }

    .recommendations-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 20px;
        margin-top: 30px;
    }

    .repo-card {
        border: 1px solid #d0d7de;
        border-radius: 6px;
        padding: 16px;
        background: white;
        transition: box-shadow 0.2s;
    }

    .repo-card:hover {
        box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }

    .repo-card h3 {
        margin: 0 0 8px 0;
        font-size: 16px;
    }

    .repo-card h3 a {
        color: #0969da;
        text-decoration: none;
    }

    .repo-card h3 a:hover {
        text-decoration: underline;
    }

    .repo-description {
        color: #57606a;
        font-size: 14px;
        margin-bottom: 12px;
        line-height: 1.5;
    }

    .repo-meta {
        display: flex;
        gap: 16px;
        font-size: 12px;
        color: #57606a;
        flex-wrap: wrap;
    }

    .repo-meta span {
        display: flex;
        align-items: center;
        gap: 4px;
    }

    .language-color {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        display: inline-block;
    }

    .topics {
        display: flex;
        flex-wrap: wrap;
        gap: 4px;
        margin-top: 8px;
    }

    .topic {
        background: #ddf4ff;
        color: #0969da;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 12px;
    }

    .reason {
        background: #fff8c5;
        border-left: 3px solid #d4a72c;
        padding: 8px 12px;
        margin-top: 12px;
        font-size: 12px;
        color: #24292f;
    }

    .stats {
        background: #f6f8fa;
        border: 1px solid #d0d7de;
        border-radius: 6px;
        padding: 15px;
        margin: 20px 0;
        display: none;
    }

    .stats.active {
        display: block;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
    }

    .stat-item {
        text-align: center;
    }

    .stat-value {
        font-size: 24px;
        font-weight: 600;
        color: #24292f;
    }

    .stat-label {
        font-size: 12px;
        color: #57606a;
        margin-top: 4px;
    }
</style>

<div class="repo-recommendations">
    <h1>üåü Repository Recommendations</h1>
    <p>Get personalized repository recommendations based on your GitHub stars!</p>

    <div class="config-section">
        <h2>Configuration</h2>
        <div class="input-group">
            <label for="githubUsername">GitHub Username</label>
            <input type="text" id="githubUsername" placeholder="Enter GitHub username" value="adongguo">
        </div>
        <div class="input-group">
            <label for="maxRecommendations">Maximum Recommendations</label>
            <input type="number" id="maxRecommendations" placeholder="Number of recommendations" value="20" min="1" max="50">
        </div>
        <button class="btn" onclick="getRecommendations()">Get Recommendations</button>
    </div>

    <div class="loading" id="loading">
        üîÑ Analyzing your starred repositories and finding recommendations...
    </div>

    <div class="error" id="error"></div>

    <div class="stats" id="stats">
        <h3>Analysis Summary</h3>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-value" id="statStars">-</div>
                <div class="stat-label">Starred Repos</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="statLanguages">-</div>
                <div class="stat-label">Languages</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="statTopics">-</div>
                <div class="stat-label">Topics</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="statRecommendations">-</div>
                <div class="stat-label">Recommendations</div>
            </div>
        </div>
    </div>

    <div class="recommendations-grid" id="recommendations"></div>
</div>

<script>
const GITHUB_API = 'https://api.github.com';
const languageColors = {
    'JavaScript': '#f1e05a',
    'Python': '#3572A5',
    'Java': '#b07219',
    'TypeScript': '#2b7489',
    'C++': '#f34b7d',
    'C': '#555555',
    'C#': '#178600',
    'PHP': '#4F5D95',
    'Ruby': '#701516',
    'Go': '#00ADD8',
    'Rust': '#dea584',
    'Swift': '#ffac45',
    'Kotlin': '#F18E33',
    'Shell': '#89e051',
    'HTML': '#e34c26',
    'CSS': '#563d7c',
    'Vue': '#41b883',
    'Dart': '#00B4AB',
    'Scala': '#c22d40',
};

async function fetchWithRetry(url, options = {}, retries = 3) {
    for (let i = 0; i < retries; i++) {
        try {
            const response = await fetch(url, options);
            if (!response.ok) {
                if (response.status === 403) {
                    throw new Error('Rate limit exceeded. Please try again later.');
                }
                if (response.status === 404) {
                    throw new Error('User not found.');
                }
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response;
        } catch (error) {
            if (i === retries - 1) throw error;
            await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
        }
    }
}

async function getStarredRepos(username) {
    const repos = [];
    let page = 1;
    const perPage = 100;
    
    while (true) {
        const response = await fetchWithRetry(
            `${GITHUB_API}/users/${username}/starred?per_page=${perPage}&page=${page}`
        );
        const data = await response.json();
        
        if (data.length === 0) break;
        repos.push(...data);
        
        if (data.length < perPage) break;
        page++;
        
        // Limit to first 500 starred repos for performance
        if (repos.length >= 500) break;
    }
    
    return repos;
}

function analyzeStarredRepos(repos) {
    const languages = {};
    const topics = {};
    const owners = {};
    
    repos.forEach(repo => {
        // Count languages
        if (repo.language) {
            languages[repo.language] = (languages[repo.language] || 0) + 1;
        }
        
        // Count topics
        if (repo.topics) {
            repo.topics.forEach(topic => {
                topics[topic] = (topics[topic] || 0) + 1;
            });
        }
        
        // Count repo owners
        if (repo.owner && repo.owner.login) {
            owners[repo.owner.login] = (owners[repo.owner.login] || 0) + 1;
        }
    });
    
    return { languages, topics, owners };
}

async function searchReposByTopic(topic, excludeRepos, limit = 5) {
    try {
        const response = await fetchWithRetry(
            `${GITHUB_API}/search/repositories?q=topic:${encodeURIComponent(topic)}&sort=stars&order=desc&per_page=${limit * 2}`
        );
        const data = await response.json();
        
        return data.items
            .filter(repo => !excludeRepos.has(repo.full_name))
            .slice(0, limit);
    } catch (error) {
        console.error(`Error searching for topic ${topic}:`, error);
        return [];
    }
}

async function searchReposByLanguage(language, excludeRepos, limit = 5) {
    try {
        const response = await fetchWithRetry(
            `${GITHUB_API}/search/repositories?q=language:${encodeURIComponent(language)}&sort=stars&order=desc&per_page=${limit * 2}`
        );
        const data = await response.json();
        
        return data.items
            .filter(repo => !excludeRepos.has(repo.full_name))
            .slice(0, limit);
    } catch (error) {
        console.error(`Error searching for language ${language}:`, error);
        return [];
    }
}

function getTopItems(obj, count) {
    return Object.entries(obj)
        .sort((a, b) => b[1] - a[1])
        .slice(0, count)
        .map(([key]) => key);
}

async function generateRecommendations(starredRepos, maxRecommendations) {
    const excludeRepos = new Set(starredRepos.map(r => r.full_name));
    const analysis = analyzeStarredRepos(starredRepos);
    
    const topLanguages = getTopItems(analysis.languages, 3);
    const topTopics = getTopItems(analysis.topics, 5);
    
    const recommendations = [];
    const seenRepos = new Set();
    
    // Get recommendations based on top topics
    for (const topic of topTopics) {
        if (recommendations.length >= maxRecommendations) break;
        
        const repos = await searchReposByTopic(topic, excludeRepos, 3);
        repos.forEach(repo => {
            if (!seenRepos.has(repo.full_name) && recommendations.length < maxRecommendations) {
                repo.recommendationReason = `Based on your interest in "${topic}"`;
                recommendations.push(repo);
                seenRepos.add(repo.full_name);
            }
        });
        
        // Small delay to avoid rate limiting
        await new Promise(resolve => setTimeout(resolve, 100));
    }
    
    // Get recommendations based on top languages
    for (const language of topLanguages) {
        if (recommendations.length >= maxRecommendations) break;
        
        const repos = await searchReposByLanguage(language, excludeRepos, 3);
        repos.forEach(repo => {
            if (!seenRepos.has(repo.full_name) && recommendations.length < maxRecommendations) {
                repo.recommendationReason = `Based on your interest in ${language}`;
                recommendations.push(repo);
                seenRepos.add(repo.full_name);
            }
        });
        
        await new Promise(resolve => setTimeout(resolve, 100));
    }
    
    return {
        recommendations: recommendations.slice(0, maxRecommendations),
        analysis: {
            totalStarred: starredRepos.length,
            topLanguages,
            topTopics,
            languageCount: Object.keys(analysis.languages).length,
            topicCount: Object.keys(analysis.topics).length
        }
    };
}

function formatNumber(num) {
    if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'k';
    }
    return num.toString();
}

function renderRecommendation(repo) {
    const languageColor = languageColors[repo.language] || '#666';
    
    return `
        <div class="repo-card">
            <h3><a href="${repo.html_url}" target="_blank">${repo.full_name}</a></h3>
            <p class="repo-description">${repo.description || 'No description available'}</p>
            <div class="repo-meta">
                ${repo.language ? `
                    <span>
                        <span class="language-color" style="background-color: ${languageColor}"></span>
                        ${repo.language}
                    </span>
                ` : ''}
                <span>‚≠ê ${formatNumber(repo.stargazers_count)}</span>
                <span>üç¥ ${formatNumber(repo.forks_count)}</span>
                ${repo.license ? `<span>üìú ${repo.license.spdx_id}</span>` : ''}
            </div>
            ${repo.topics && repo.topics.length > 0 ? `
                <div class="topics">
                    ${repo.topics.slice(0, 5).map(topic => `<span class="topic">${topic}</span>`).join('')}
                </div>
            ` : ''}
            ${repo.recommendationReason ? `
                <div class="reason">üí° ${repo.recommendationReason}</div>
            ` : ''}
        </div>
    `;
}

function showError(message) {
    const errorDiv = document.getElementById('error');
    errorDiv.textContent = message;
    errorDiv.classList.add('active');
}

function hideError() {
    const errorDiv = document.getElementById('error');
    errorDiv.classList.remove('active');
}

function showLoading() {
    document.getElementById('loading').classList.add('active');
    document.querySelector('.btn').disabled = true;
}

function hideLoading() {
    document.getElementById('loading').classList.remove('active');
    document.querySelector('.btn').disabled = false;
}

function updateStats(analysis) {
    document.getElementById('statStars').textContent = analysis.totalStarred;
    document.getElementById('statLanguages').textContent = analysis.languageCount;
    document.getElementById('statTopics').textContent = analysis.topicCount;
    document.getElementById('statRecommendations').textContent = analysis.recommendations;
    document.getElementById('stats').classList.add('active');
}

async function getRecommendations() {
    const username = document.getElementById('githubUsername').value.trim();
    const maxRecommendations = parseInt(document.getElementById('maxRecommendations').value) || 20;
    
    if (!username) {
        showError('Please enter a GitHub username');
        return;
    }
    
    hideError();
    showLoading();
    
    const recommendationsDiv = document.getElementById('recommendations');
    recommendationsDiv.innerHTML = '';
    
    try {
        // Fetch starred repositories
        const starredRepos = await getStarredRepos(username);
        
        if (starredRepos.length === 0) {
            showError(`User ${username} has no starred repositories.`);
            hideLoading();
            return;
        }
        
        // Generate recommendations
        const result = await generateRecommendations(starredRepos, maxRecommendations);
        
        // Update stats
        updateStats({
            ...result.analysis,
            recommendations: result.recommendations.length
        });
        
        // Render recommendations
        if (result.recommendations.length === 0) {
            recommendationsDiv.innerHTML = '<p>No recommendations found. Try adjusting your preferences.</p>';
        } else {
            recommendationsDiv.innerHTML = result.recommendations
                .map(repo => renderRecommendation(repo))
                .join('');
        }
        
        hideLoading();
    } catch (error) {
        console.error('Error:', error);
        showError(`Error: ${error.message}`);
        hideLoading();
    }
}

// Auto-load recommendations on page load for default user
window.addEventListener('DOMContentLoaded', () => {
    const username = document.getElementById('githubUsername').value;
    if (username) {
        // Optional: auto-load for default user
        // getRecommendations();
    }
});
</script>
